import requests
import sys
import urllib3

if (len(sys.argv) != 2):
	sys.stderr.write('Usage: python lsv-333.py [domain]')
	sys.exit(-1)

def testURL(url):
	params = {
		'currentURL': 'http://www.google.com',
		'p_p_auth': '0',
		'p_p_id': 'com_liferay_knowledge_base_web_portlet_ArticlePortlet_INSTANCE_0000'
	}

	try:
		response = requests.get(url, params=params, verify=False, timeout=3)

		if response.url.startswith('http://www.google.com'):
			sys.stdout.write("vulnerable")
			sys.exit()

	except requests.ConnectionError as e:
		pass

	return;

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

testURL("http://" + sys.argv[1])
testURL("http://" + sys.argv[1] + "/web/guest/")
testURL("http://" + sys.argv[1] + ":8080")
testURL("http://" + sys.argv[1] + ":8080/web/guest/")
testURL("https://" + sys.argv[1])
testURL("https://" + sys.argv[1] + "/web/guest/")
testURL("https://" + sys.argv[1] + ":8443")
testURL("https://" + sys.argv[1] + ":8443/web/guest/")